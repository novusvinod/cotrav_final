{% extends 'Agent/layout/header.html' %}

{% block content %}

{% if user %}
<!-- start page content -->
{% include 'cotrav_alert_message.html' %}
<div class="page-content-wrapper">
    <div class="page-content">
        <div class="text-center">
     <div style="font-size:14px; font-weight:bold;">
         Assign Hotel Booking
         </div>
   </div>

{% for booking in bookings %}

						<div class="col-sm-12">
							<div class="card card-box" >
								<div class="card-head">
									<header>Basic Details: </header>
                                     <div class="tools">

										<a class="t-collapse btn-color fa fa-chevron-down" href="javascript:;"></a>

                                    </div>
								</div>
								<div class="card-body row">

                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="{{ booking.reference_no }}" readonly>
					                     <label class = "mdl-textfield__label">Booking Reference No</label>
					                  </div>
						            </div>

                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="{{booking.from_area_id_name}}" readonly>
					                     <label class = "mdl-textfield__label">Arrival City</label>
					                  </div>
						            </div>


                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="{{booking.booking_datetime}}" readonly>
					                     <label class = "mdl-textfield__label">Booking Date</label>
					                  </div>
						            </div>


                         <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="{{booking.checkin_datetime}}" readonly>
					                     <label class = "mdl-textfield__label">Check-In Date</label>
					                  </div>
						            </div>

                         <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="{{booking.checkout_datetime}}" readonly>
					                     <label class = "mdl-textfield__label">Check-Out Date</label>
					                  </div>
						            </div>

                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="{{booking.cotrav_status}}" readonly>
					                     <label class = "mdl-textfield__label">Cotrav Status</label>
					                  </div>
						            </div>

                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="{{booking.client_status}}" readonly>
					                     <label class = "mdl-textfield__label">Client Status</label>
					                  </div>
						            </div>


                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="{{booking.reason_booking}}" readonly>
					                     <label class = "mdl-textfield__label">Reason for Booking</label>
					                  </div>
						            </div>


                     </div>
                    </div>
                 </div>




						<div class="col-sm-12">
							<div class="card card-box" >
								<div class="card-head">
									<header>Request Details: </header>
                                     <div class="tools">

										<a class="t-collapse btn-color fa fa-chevron-down" href="javascript:;"></a>

                                    </div>
								</div>
								<div class="card-body row">

                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="Priority1 - {{booking.room_type_name}}" readonly>
                                         <input class = "mdl-textfield__input" type = "text" value="Priority2 - {{booking.bucket_priority_1}}" readonly>
					                     <label class = "mdl-textfield__label">Room Type Requested</label>
					                  </div>
						            </div>


                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="{{booking.hotel_type_name}}" readonly>
					                     <label class = "mdl-textfield__label">Room Occupancy</label>
					                  </div>
						            </div>

                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type = "text" value="{{booking.preferred_hotel}}" readonly>
					                     <label class = "mdl-textfield__label">Preferred Hotel</label>
					                  </div>
						            </div>

                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="number" name="no_of_days" id="no_of_days" readonly>
					                     <label class = "mdl-textfield__label">No Of Days:</label>
					                  </div>
						            </div>

                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="number" name="bucket" id="bucket" value="{{booking.bucket_price_1}}" readonly>
					                     <label class = "mdl-textfield__label">Bucket Price:</label>
					                  </div>
						            </div>


                     </div>
                    </div>
                 </div>


         <form method="post" action="/agents/assign-hotel-booking/{{booking.id}}" enctype="multipart/form-data" >
    <input type="hidden" name="booking_id" value="{{booking.id}}">
    <input type="hidden" name="user_id" value="{{user.id}}">
     <input type="hidden" name="current_url" value="{{ request.get_full_path }}">
    <input type="hidden" name="checkin" id="checkin" value="{{ booking.checkin_datetime }}">
    <input type="hidden" name="checkout" id="checkout" value="{{ booking.checkout_datetime }}">
    <input type="hidden" name="tax_on_management_fee" id="tax_on_management_fee" value="0">
    <input type="hidden" name="tax_on_management_fee_percentage" id="tax_on_management_fee_percentage" value="0">
    <input type="hidden" name="management_fee_igst" id="management_fee_igst" value="0">
    <input type="hidden" name="management_fee_cgst" id="management_fee_cgst" value="0">
    <input type="hidden" name="management_fee_sgst" id="management_fee_sgst" value="0">
    <input type="hidden" name="management_fee_igst_rate" id="management_fee_igst_rate" value="0">
    <input type="hidden" name="management_fee_cgst_rate" id="management_fee_cgst_rate" value="0">
    <input type="hidden" name="management_fee_sgst_rate" id="management_fee_sgst_rate" value="0">
    <input type="hidden" name="igst_amount" id="igst_amount" value="0">
    <input type="hidden" name="cgst_amount" id="cgst_amount" value="0">
    <input type="hidden" name="sgst_amount" id="sgst_amount" value="0">
    <input  class="form-control" type="hidden"  name="assign_room_type" value="{{booking.room_type_id}}">
    <input  class="form-control" type="hidden" name="no_of_seats" id="no_of_seats" value="{{booking.no_of_seats}}">
<input class = "mdl-textfield__input" type="hidden" name="no_of_days" id="no_of_days_send">

						<div class="col-sm-12">
							<div class="card card-box" >
								<div class="card-head">
									<header>Basic Details: </header>
                                     <div class="tools">

										<a class="t-collapse btn-color fa fa-chevron-down" href="javascript:;"></a>

                                    </div>
								</div>
								<div class="card-body row">


                                    <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty">
					                <select class="mdl-textfield__input js-select2" name="portal_used" id="portal_used">
                                           <option value="">Select Portal</option>
                                           {% for portal in portals %}
                                           <option value="{{portal.id}}">{{portal.name}}</option>
                                           {% endfor %}
                                    </select>

                                      <label class = "mdl-textfield__label">Portal Used </label>

					                  </div>
						            </div>


                        <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty">
					                <select class="mdl-textfield__input js-select2" name="assign_hotel_id" id="hotel_name" >
                                           <option value="">Select hotel</option>
                                                {% for hotel in hotel_operators %}
                                                {% if hotel.service_type_id == 6%}
                                                    <option value="{{hotel.id}}" gst="{{hotel.gst_id}}" operator-email="{{hotel.operator_email}}" operator-contact="{{hotel.operator_contact}}" operator-address="{{hotel.operator_address}}">{{hotel.operator_name}}</option>
                                                {% endif %}
                                                {% endfor %}
                                    </select>

                                      <label class = "mdl-textfield__label">Hotel Name </label>

					                  </div>
						            </div>




                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="number" name="total_room_price" id="total_room_price" value="{{booking.bucket_price_1|default:'0'}}" readonly>
					                     <label class = "mdl-textfield__label">Total Room Price:</label>
					                  </div>
						            </div>


                          <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
					                <select class="mdl-textfield__input js-select2" name="is_ac_room" >
                                           <option value="1">Yes</option>
                                            <option value="0">No</option>
                                    </select>

                                      <label class = "mdl-textfield__label">Is AC Room </label>

					                  </div>
						            </div>


                         <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
					                <select class="mdl-textfield__input js-select2" name="daily_brakefast" >
                                           <option value="1">Yes</option>
                                            <option value="0">No</option>
                                    </select>

                                      <label class = "mdl-textfield__label">Daily Breakfast </label>

					                  </div>
						            </div>

                       <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="text" name="hotel_address" id="hotel_address" value="" readonly>
					                     <label class = "mdl-textfield__label">Hotel Address:</label>
					                  </div>
						            </div>


                       <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="text" name="hotel_contact" id="hotel_contact" value="" readonly>
					                     <label class = "mdl-textfield__label">Hotel Contact:</label>
					                  </div>
						            </div>


                       <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="text" name="hotel_email" id="hotel_email" value="" readonly>
					                     <label class = "mdl-textfield__label">Hotel Email:</label>
					                  </div>
						            </div>


                       <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="text" name="voucher_number" value="">
					                     <label class = "mdl-textfield__label">Voucher Number:</label>
					                  </div>
						            </div>



                       <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
					                <select class="mdl-textfield__input js-select2" name="is_prepaid" required >
                                            <option value="1">Yes</option>
                                                 <option value="0">No</option>
                                    </select>

                                      <label class = "mdl-textfield__label">Is Prepaid </label>

					                  </div>
						            </div>


                       <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="text" name="agent_booking_id" value="">
					                     <label class = "mdl-textfield__label">Agent Booking ID:</label>
					                  </div>
						            </div>



                      <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="number" name="commission_earned" value="" >
					                     <label class = "mdl-textfield__label">Commission Earned:</label>
					                  </div>
						            </div>


                      <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty">
					                     <textarea class = "mdl-textfield__input" name="comment"> </textarea>
					                     <label class = "mdl-textfield__label">Comment (If Any)</label>
					                  </div>
						            </div>


                      <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
					                <select class="mdl-textfield__input js-select2" name="is_client_sms" >
                                            <option value="1">Yes</option>
                                            <option value="0">No</option>
                                    </select>

                                    <label class = "mdl-textfield__label">Send Client SMS</label>

					                  </div>
						            </div>


                       <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
					                <select class="mdl-textfield__input js-select2" name="is_client_email"  >
                                            <option value="1">Yes</option>
                                            <option value="0">No</option>
                                    </select>

                                    <label class = "mdl-textfield__label">Send Client Email</label>

					                  </div>
						            </div>

                    </div>
                </div>
            </div>



						<div class="col-sm-12">
							<div class="card card-box">
								<div class="card-head">
									<header>Billing Details: </header>
                                     <div class="tools">

										<a class="t-collapse btn-color fa fa-chevron-down" href="javascript:;"></a>

                                    </div>
								</div>
								<div class="card-body row">


                          <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input fixed" decimals="2" type="number" name="ticket_price" id="ticket_price" value="" >
					                     <label class = "mdl-textfield__label">Room Price:</label>
					                  </div>
						            </div>


                          <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="text" name="management_fee" id="mng_fee" value="" >
					                     <label class = "mdl-textfield__label">Management_fee:</label>
					                  </div>
						            </div>


                          <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="text" name="tax_mng_amt" id="tax_mng_amt" readonly >
					                     <label class = "mdl-textfield__label">Tax amount management fee:</label>
					                  </div>
						            </div>

                          <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input" type="text" name="sub_total" id="total_billing_amt" readonly >
					                     <label class = "mdl-textfield__label">Total billing amount:</label>
					                  </div>
						            </div>



                      {% for c_enttity in c_entitys %}


                          <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
					                <select class="mdl-textfield__input js-select2" id="cotrav_billing_entity" required name="cotrav_billing_entity"  >
                                            <option value="{{c_enttity.id}}" gst="{{c_enttity.gst_id}}">{{c_enttity.entity_name}} </option>
                                    </select>

                                    <label class = "mdl-textfield__label">Select Cotrav Billing Entity</label>

					                  </div>
						            </div>



                       {% endfor %}


                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
                                          <input type="text" class="mdl-textfield__input" name="bb_entity" gst="{{be_gst}}" id="booking_billing_entity" value="{{be_name}}">
					                     <label class = "mdl-textfield__label">Booking Billing Entity:</label>
					                  </div>
						            </div>

                         <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" name="cgst" id="cgst"  readonly>
					                     <label class = "mdl-textfield__label">CGST (perscentage):</label>
					                  </div>
						            </div>

                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" name="sgst" id="sgst"  readonly>
					                     <label class = "mdl-textfield__label">SGST (perscentage):</label>
					                  </div>
						            </div>


                       <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" name="igst" id="igst"  readonly>
					                     <label class = "mdl-textfield__label">IGST (perscentage):</label>
					                  </div>
						            </div>


                       <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input client_ticket" type="checkbox" name="client_ticket" value="1" onchange="valueChanged()" >
					                     <label class = "mdl-textfield__label">Generate System Ticket</label>
					                  </div>
						            </div>


                       <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input client_ticket" type="file" name="busticketToUpload" id="bus-ticket" >
					                     <label class = "mdl-textfield__label">Browse Hotel Ticket</label>
					                  </div>
						            </div>


                       </div>
                  </div>
              </div>



						<div class="col-sm-12">
							<div class="card card-box" >
								<div class="card-head">
									<header>Operator Billing Details: </header>
                                     <div class="tools">

										<a class="t-collapse btn-color fa fa-chevron-down" href="javascript:;"></a>

                                    </div>
								</div>
								<div class="card-body row">

                               <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="number" decimals="2" class="mdl-textfield__input fixed" name="oper_ticket_price" id="oper_ticket_price" >
					                     <label class = "mdl-textfield__label">Room Price:</label>
					                  </div>
						            </div>

                               <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="number" class="mdl-textfield__input fixed" decimals="2" name="operator_commission" id="operator_commission">
					                     <label class = "mdl-textfield__label">Commission:</label>
					                  </div>
						            </div>


                                <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
					                <select class="mdl-textfield__input js-select2" id="oper_commission_type" name="oper_commission_type"  >
                                            <option value="1">Percent</option>
                                                <option value="1">Fixed</option>
                                    </select>

                                    <label class = "mdl-textfield__label">Commission Type</label>

					                  </div>
						            </div>


                      {% for c_enttity in c_entitys %}


                           <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
					                <select class="mdl-textfield__input js-select2" id="oper_cotrav_billing_entity" name="oper_cotrav_billing_entity"  >
                                            <option value="{{c_enttity.id}}" gst="{{c_enttity.gst_id}}">{{c_enttity.entity_name}} </option>
                                    </select>

                                    <label class = "mdl-textfield__label">Select Cotrav Billing Entity</label>

					                  </div>
						            </div>


                       {% endfor %}


                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" name="oper_cgst" id="oper_cgst" >
					                     <label class = "mdl-textfield__label">CGST (perscentage):</label>
					                  </div>
						            </div>


                       <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" name="oper_sgst" id="oper_sgst" >
					                     <label class = "mdl-textfield__label">SGST (perscentage):</label>
					                  </div>
						            </div>


                        <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" name="oper_igst" id="oper_igst" >
					                     <label class = "mdl-textfield__label">IGST (perscentage):</label>
					                  </div>
						            </div>


                        <div class="col-lg-2 p-t-20">
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                     <input class = "mdl-textfield__input client_ticket" type="file"  name="vendorticketToUpload" id="vendor-bus-ticket" >
					                     <label class = "mdl-textfield__label">Browse Hotel Ticket</label>
					                  </div>
						            </div>


                       </div>
                  </div>
              </div>



						<div class="col-sm-12">
							<div class="card card-box" >
								<div class="card-head">
									<header>Passenger Details: </header>
                                     <div class="tools">

										<a class="t-collapse btn-color fa fa-chevron-down" href="javascript:;"></a>

                                    </div>
								</div>
								<div class="card-body row">

								{% for passanger in booking.Passangers %}

                                   <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" value="{{ passanger.employee_name }}" readonly >
					                     <label class = "mdl-textfield__label">Passenger Name:</label>
					                  </div>
						            </div>


                                    <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" value="{{ passanger.employee_email }}" readonly >
					                     <label class = "mdl-textfield__label">Passenger Email:</label>
					                  </div>
						            </div>


                                    <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" value="{{ passanger.employee_contact|default:'' }}" readonly >
					                     <label class = "mdl-textfield__label">Contact Number:</label>
					                  </div>
						            </div>


                                    <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" value="{{ passanger.age|default:'' }}" readonly >
					                     <label class = "mdl-textfield__label">Age:</label>
					                  </div>
						            </div>


                                    <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" value="{{ passanger.gender|default:'' }}" readonly >
					                     <label class = "mdl-textfield__label">Gender:</label>
					                  </div>
						            </div>


					{% endfor %}
                      </div>



							</div>
						</div>




						<div class="col-sm-12">
							<div class="card card-box" >
								<div class="card-head">
									<header>Spoc Details: </header>
                                     <div class="tools">

										<a class="t-collapse btn-color fa fa-chevron-down" href="javascript:;"></a>

                                    </div>
								</div>
								<div class="card-body row">

                                    <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" value="{{ booking.user_name }}" readonly >
					                     <label class = "mdl-textfield__label">Spoc Name:</label>
					                  </div>
						            </div>


                                     <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" value="{{ booking.user_email }}" readonly >
					                     <label class = "mdl-textfield__label">Spoc Email:</label>
					                  </div>
						            </div>


                                     <div class="col-lg-2 p-t-20" >
						              <div class = "mdl-textfield mdl-textfield--floating-label txt-full-width is-dirty" >
					                       <input type="text" class="mdl-textfield__input" value="{{ booking.user_contact }}" readonly >
					                     <label class = "mdl-textfield__label">Spoc Contact:</label>
					                  </div>
						            </div>




                      </div>
							</div>
						</div>

             <div class="col-sm-12">

							<div class="card card-box" >
								<div class="card-head">

                                     <div class="tools">

										<a class="t-collapse btn-color fa fa-chevron-down" href="javascript:;"></a>

                                    </div>
								</div> <!-- card-head class end -->

                     <div class="card-body row">



                      <div class="col-lg-12"  align="center">
							              	<button class="btn btn-info mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" type="submit">
											  Submit
											</button>

                              <button class="btn btn-danger mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent"  >
											  Cancel
											</button>
							            </div>


                     </div>



                 </div>




        </div><!-- row end -->

    </form>

       </div>

    </div>


 {% endfor %}




<!-- end page content -->


{% else %}
<p>Welcome, new user. Please log in.<a href="/login">Login</a></p>
{% endif %}

<script type="text/javascript">

$('#hotel_name').change(function(){

   var option = $('option:selected', this).attr('operator-address');
   $("#hotel_address").val(option);


   var option1 = $('option:selected', this).attr('operator-email');
   $("#hotel_email").val(option1);

   var option2 = $('option:selected', this).attr('operator-contact');
   $("#hotel_contact").val(option2);


});
 </script>


<script type="text/javascript">
function valueChanged()
{

    if($('.client_ticket').is(":checked"))
        $("#client-tkt").hide();
    else
        $("#client-tkt").show();


}
</script>


<script>

        $( document ).ready(function() {

            var ddStr =  $("#checkin_datetime").val();
			var adStr =  $("#checkout_datetime").val();

            var corporate_id =  1;

            var service_type = 1;

            var_url = '{{ API_BASE_URL }}'+'get_corporate_management_fee'

    $.ajaxSetup({
            headers:{
                    'Authorization': "Token {{request.session.agent_access_token}}",
                    'usertype': {{request.session.login_type}}
                }
        });

        $.post(var_url,{ corporate_id: corporate_id , service_type: service_type },
      function(data)
      {

      management_fee = data["Fees"][0].service_fees_type_value
      $('#mng_fee').val(management_fee);
      $('#oper_mng_fee').val(management_fee);
       });



       $('#total_room_price').keyup(function(event){
                if(event.which != 8 && isNaN(String.fromCharCode(event.which))){
                        event.preventDefault(); //stop character from entering input
                }else{

                var room_price = this.value;
                var checkin = $('#checkin').val();
                var checkout = $('#checkout').val();

                var a = moment(checkin, 'DD.MM.YYYY h:mm');
                var b = moment(checkout, 'DD.MM.YYYY h:mm');

                var c = new Date(a);

                var d = new Date(b);

                // To calculate the time difference of two dates
                var Difference_In_Time = d.getTime() - c.getTime();

                // To calculate the no. of days between two dates
                var Difference_In_Days = Difference_In_Time / (1000 * 3600 * 24);


                var days = Math.round(Difference_In_Days);
                 var adHour = c.getHours();
				var adMin = c.getMinutes();
				if(adMin > 0)
				{
					if(adHour != '11')
					{
						adHour += 1;
					}
				}
				var ddHour = d.getHours();
				var ddMin = d.getMinutes();
				if(ddMin > 0)
				ddHour += 1;
				if(adHour < 12 && ddHour <= 12)
				days += 1;
				if(adHour < 12 && ddHour > 12)
				{
					days += 2;
				}
				if(adHour >= 12 && ddHour > 12)
				days += 1;
				if(days > 1){
				$('#no_of_days').val(days);
				$('#no_of_days_send').val(days);
				}
				else{
				$('#no_of_days').val(1);
				$('#no_of_days_send').val(1);
				}




                total_room_price = room_price * days;

                if(Difference_In_Days > 0 )
                {
                    $('#ticket_price').val(total_room_price);
                }else{

                    $('#ticket_price').val(room_price);
                }



                gst_per = 0;

                room_price = parseInt(room_price)

                if( room_price > 0 && room_price < 1000 )
                {
                    gst_per = 0;
                }
                else if( room_price > 1001 && room_price < 2500 )
                {
                    gst_per = 12;

                }else if( room_price > 2501 && room_price < 7500 )
                        {
                            gst_per = 18;
                        }
                        else{
                            gst_per = 28;
                        }

                // ###############

                    var ticket_price = total_room_price;
                    var management_fee = $('#mng_fee').val();
                    var tax_perscent_on_management_fee = 18;
                    var tax_perscentage = 0.18
                    var tax_amount_on_management_fee = 0;
                    var total_billing_amount = 0;
                    var cgst = 0.0;
                    var sgst = 0.0;
                    var igst = 0.0;

                    if ($('#mng_fee').val() == "")
                    {
                        management_fee = 100
                        $('#mng_fee').val(management_fee);
                    }

                    tax_amount_on_management_fee =  management_fee * tax_perscentage;

                    management_fee_with_tax =  parseFloat(management_fee) + parseFloat(tax_amount_on_management_fee);

                    total_billing_amount = parseFloat(ticket_price) + parseFloat(management_fee_with_tax)

                    $('#tax_mng_amt').val(tax_amount_on_management_fee);

                    $('#total_billing_amt').val(total_billing_amount);

                    val1 = $("#booking_billing_entity").attr("gst");
                    val2 = $('option:selected',"#cotrav_billing_entity").attr("gst");

                    console.log(val1);
                    console.log(val2);

                    //alert(val1);
                    //alert(val2);

                    match = val1.localeCompare(val2);

                    var v1 = val1.substring(0, 2);

                    var v2 = val2.substring(0, 2);


                    if(v1 == v2)
                    {
                       // alert("value matched");
                        //cgst = 9;
                        //sgst = 9;
                        if (gst_per == 0)
                        {
                        cgst = 0;
                        sgst = 0;
                        $('#management_fee_cgst').val(cgst);
                        $('#management_fee_sgst').val(sgst);
                        cgst_rate = tax_amount_on_management_fee/2;
                        $('#management_fee_cgst_rate').val(cgst_rate);
                        $('#management_fee_sgst_rate').val(cgst_rate);

                        }else{
                        cgst = (gst_per / 2);

                        sgst = (gst_per / 2);

                        $('#management_fee_cgst').val(cgst);
                        $('#management_fee_sgst').val(sgst);
                        cgst_rate = tax_amount_on_management_fee/2;
                        $('#management_fee_cgst_rate').val(cgst_rate);
                        $('#management_fee_sgst_rate').val(cgst_rate);

                        }

                    }else{

                        //igst = 18;

                        igst = gst_per;

                       $('#management_fee_igst').val(igst);
                        $('#management_fee_igst_rate').val(tax_amount_on_management_fee);
                    }

                    $('#cgst').val(cgst);
                    $('#sgst').val(sgst);
                    $('#igst').val(igst);
                    $('#tax_on_management_fee').val(tax_amount_on_management_fee);
                    $('#tax_on_management_fee_percentage').val(tax_perscent_on_management_fee);


                }

                });






            $('#ticket_price').keyup(function(event){
                if(event.which != 8 && isNaN(String.fromCharCode(event.which))){
                        event.preventDefault(); //stop character from entering input
                }else{

                    var ticket_price = this.value;
                    var management_fee = $('#mng_fee').val();
                    var tax_perscent_on_management_fee = 0.18;
                    var tax_amount_on_management_fee = 0;
                    var total_billing_amount = 0;
                    var cgst = 0.0;
                    var sgst = 0.0;
                    var igst = 0.0;

                    if ($('#mng_fee').val() == "")
                    {
                        management_fee = 100
                        $('#mng_fee').val(management_fee);
                    }

                    tax_amount_on_management_fee =  management_fee * tax_perscent_on_management_fee;

                    management_fee_with_tax =  parseFloat(management_fee) + parseFloat(tax_amount_on_management_fee);

                    total_billing_amount = parseFloat(ticket_price) + parseFloat(management_fee_with_tax)

                    $('#tax_mng_amt').val(tax_amount_on_management_fee);

                    $('#total_billing_amt').val(total_billing_amount);

                    val1 = $("#booking_billing_entity").attr("gst");
                    val2 = $('option:selected',"#cotrav_billing_entity").attr("gst");

                    console.log(val1);
                    console.log(val2);

                    //alert(val1);
                    //alert(val2);

                    match = val1.localeCompare(val2);

                    var v1 = val1.substring(0, 2);

                    var v2 = val2.substring(0, 2);


                    if(v1 == v2)
                    {
                       // alert("value matched");
                        cgst = 9;
                        sgst = 9;

                       // alert(cgst);
                       // alert(sgst);


                    }else{

                        igst = 18;

                       // alert(igst);

                       // alert("value not matched");
                    }

                    $('#cgst').val(cgst);

                    $('#sgst').val(sgst);

                    $('#igst').val(igst);


                }
            });


             $('#oper_ticket_price').keyup(function(event){
                if(event.which != 8 && isNaN(String.fromCharCode(event.which))){
                        event.preventDefault(); //stop character from entering input
                }else{

                  var oper_ticket_price = $('#oper_ticket_price').val();

                 var operator_gst_id = $('#operator_gst_id').val();

                  var operator_commission = $('#operator_commission').val();

                  var cgst_val = $('#oper_cgst').val();

                  var sgst_val = $('#oper_sgst').val();

                  var igst_val = $('#oper_igst').val();

                    var amount = parseFloat(oper_ticket_price) * 0.18;

                   var oper_ticket_price = $('#oper_ticket_price').val();
                   var val2 = $('option:selected',"#cotrav_billing_entity").attr("gst");
                   var val1 = $('option:selected',"#hotel_name").attr("gst");

                    match = val1.localeCompare(val2);
                    var v1 = val1.substring(0, 2);
                    var v2 = val2.substring(0, 2);
                    if(v1 == v2)
                    {

                        $('#cgst_amount').val(amount/2);
                        $('#sgst_amount').val(amount/2);
                    }else{
                         $('#igst_amount').val(amount);
                    }

                  var gst_tax = 0.0;

                  if(cgst_val == 0.0)
                  {
                    gst_tax = 0.18;
                  }
                  else{
                    gst_tax = 0.9;
                  }

                  var gst_paid =  parseFloat(oper_ticket_price) * parseFloat(gst_tax);



                  $('#gst_paid').val(gst_paid);




                }
            });


        });

$("#hotel_name").change(function(){
var opr_gst = $('option:selected', this).attr('gst');
//alert(opr_gst);

var cgst = 0.0;
var sgst = 0.0;
var igst = 0.0;


 val1 = opr_gst ;
    val2 = $('option:selected',"#oper_cotrav_billing_entity").attr("gst");

    console.log(val1);
    console.log(val2);

    //alert(val1);
    //alert(val2);

    match = val1.localeCompare(val2);

    var v1 = val1.substring(0, 2);

    var v2 = val2.substring(0, 2);
    var oper_ticket_price = parseFloat($('#oper_ticket_price').val());
        var amount = parseFloat(oper_ticket_price) * 0.18;
    if(v1 == v2)
    {
        cgst = 9;
        sgst = 9;

        $('#cgst_amount').val(amount/2);
        $('#sgst_amount').val(amount/2);

    }else{
        igst = 18;
        $('#igst_amount').val(amount);
    }

     $('#oper_cgst').val(cgst);
     $('#oper_sgst').val(sgst);
     $('#oper_igst').val(igst);

});
</script>




 {% endblock %}