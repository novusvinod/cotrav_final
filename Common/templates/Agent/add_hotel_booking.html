{% extends 'Agent/layout/header.html' %}

{% block content %}

{% load static %}

{% if user %}

<style>

.disableClick{
    pointer-events: none;
}

.js-select2{
width: 100%;

}

</style>


<!-- start page content -->
<!-- The Modal -->
<div class="modal fade model_custom_style" role="dialog" id="add_employee_modal">
    <div class="modal-dialog">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4  class="modal-title-status">Add Employee Details </h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
            <form action="/agents/add-employee/0" method="post" id="modal_add_employee" enctype="multipart/form-data" >


                <input type="hidden" name="current_url" value="{{ request.get_full_path }}">

                <input type="hidden" name="modal_add_employee" value="1">


                <div class="form-group row">

                <label class="col-sm-5 control-label">Select Company</label>
                <div class="col-sm-7">
                <select class="form-control myselect" style="width:100%;" name="corporate_id" id="corporate_id2"  required>
	                                                <option value="">Select Company</option>
                                                        {% for company in companies %}
                                                        <option value="{{company.id}}">{{company.corporate_name}}</option>
                                                        {% endfor %}
	                                         </select>
                </div>
                </div>




                <div class="form-group row">

                <label class="col-sm-5 control-label">Select Spoc</label>
                <div class="col-sm-7">
                <select class="form-control myselect" style="width:100%;" name="spoc_id" id="spoc_id2" required>
	                                                <option value="">Select Spoc</option>
                                                        {% for spoc in spocs %}
                                                        <option value="{{spoc.id}}">{{spoc.user_name}}</option>
                                                        {% endfor %}
	                                         </select>
                </div>
                </div>



                <div class="form-group row">
                    <label class="col-sm-5 control-label">Billing Entity</label>
                    <div class="col-sm-7">
                    <select class="form-control myselect" style="width:100%;" name="billing_entity_id" id="billing_entity_id2"  required>
	                                                 <option value="">Select Billing Entity</option>
                                                        {% for entity in entitys %}
                                                        <option value="{{entity.id}}">{{entity.entity_name}}</option>
                                                        {% endfor %}
                    </select>
                    </div>
                </div>


                <div class="form-group row">
                     <label class="col-sm-5 control-label">Core Employee ID</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" name="core_employee_id" required>
                    </div>
                </div>

                <div class="form-group row">
                     <label class="col-sm-5 control-label">Employee Name</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" name="employee_name" required>
                    </div>
                </div>

                <div class="form-group row">
                     <label class="col-sm-5 control-label">Employee Email</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" name="employee_email" required>
                    </div>
                </div>


                <div class="form-group row">
                     <label class="col-sm-5 control-label">Employee Contact</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" name="employee_contact" required>
                    </div>
                </div>

                <div class="form-group row">
                     <label class="col-sm-5 control-label">Date Of Birth</label>
                    <div class="col-sm-7">
                        <input class = "form-control datepicker1" type="text" name="date_of_birth" required >
                    </div>
                </div>


                <div class="form-group row">
                     <label class="col-sm-5 control-label">Home City</label>
                    <div class="col-sm-7">
                        <input class = "form-control" type="text" name="home_city" required >
                    </div>
                </div>


                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
            </div>

        </div>
    </div>
</div>


<!-- The update Modal -->
<div class="modal fade model_custom_style" role="dialog" id="update_employee_modal">
    <div class="modal-dialog">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4  class="modal-title-status">Update Employee Details </h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
            <form action="/api/update-passanger" method="post" id="modal_update_employee" enctype="multipart/form-data" >


                <input type="hidden" name="current_url" value="{{ request.get_full_path }}">

                <input type="hidden" name="employee_id" id="employee_id" value="">


                <div class="form-group row">
                     <label class="col-sm-5 control-label">Core Employee ID</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" id="core_employee_id" name="core_employee_id" required>
                    </div>
                </div>

                <div class="form-group row">
                     <label class="col-sm-5 control-label">Employee Name</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" id="employee_name" name="employee_name" required>
                    </div>
                </div>

                <div class="form-group row">
                     <label class="col-sm-5 control-label">Employee Email</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" id="employee_email" name="employee_email" required>
                    </div>
                </div>


                <div class="form-group row">
                     <label class="col-sm-5 control-label">Employee Contact</label>
                    <div class="col-sm-7">
                        <input type="text" class="form-control" id="employee_contact" name="employee_contact" required>
                    </div>
                </div>

               <!-- <div class="form-group row">
                     <label class="col-sm-5 control-label">Date Of Birth</label>
                    <div class="col-sm-7">
                        <input class = "form-control date" type="text" id="date_of_birth" name="date_of_birth" required >
                    </div>
                </div>


                <div class="form-group row">
                     <label class="col-sm-5 control-label">Home City</label>
                    <div class="col-sm-7">
                        <input class = "form-control" type="text" id="home_city" name="home_city" required >
                    </div>
                </div> -->


                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
            </div>

        </div>
    </div>
</div>






{% include 'cotrav_alert_message.html' %}
<div class="page-content-wrapper">
    <div class="page-content">

         <div class="text-center">
            <div style="font-size:14px; font-weight:bold;">
                Add New Train Booking Details
            </div>
   </div>

 <form method="post" action="/agents/add-hotel-booking/{{user.id}}" enctype="multipart/form-data">
      {% csrf_token %}
     <input type="hidden" class="col-sm-8 form-control" name="cotrav_agent_id"  value="{{user.id }}">
     <input type="hidden" class="col-sm-8 form-control" name="user_id"  value="{{user.id }}">
      <input type="hidden" name="current_url" value="{{ request.get_full_path }}">
     <input type="hidden" name="no_of_nights" id="no_of_nights">

                    <div class="row">
                        <div class="col-md-4">
                            <div class="card card-topline-aqua">
                                <div class="card-head">
                                    <header>Booking Details</header>

				                        <ul class = "mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect"
				                           data-mdl-for = "panel-button">
				                           <li class = "mdl-menu__item"><i class="material-icons">assistant_photo</i>Action</li>
				                           <li class = "mdl-menu__item"><i class="material-icons">print</i>Another action</li>
				                           <li class = "mdl-menu__item"><i class="material-icons">favorite</i>Something else here</li>
				                        </ul>
                                </div>
                                <div class="card-body " id="bar-parent">

                                          <div class="form-group row">
                                            <label class="col-sm-4">Company Name</label>

                                            <select class="col-sm-8 form-control  myselect" style="width:66%"  name="corporate_id" id="corporate_id"  required>
                                                <option value="">Select Company Name</option>
                                               
                                                {% for company in companies %}
                                                    <option value="{{company.id}}">{{company.corporate_name}}</option>
                                                {% endfor %}


                                               
                                            </select>
                                        
                                            </div>
                                            

                                            <div class="form-group row">
                                                    <label class="col-sm-4">Booking Email Copy</label>
                                                    <input type="file" class="col-sm-8 form-control" name="email_attachment"  placeholder="Booking Email Copy" >
                                                    </div>
                                    <div class="form-group row">
                                <label class="col-sm-4" >Travel Request No.</label>
                                 <input type="text" class="form-control col-sm-8" name="bta_code_travel_req_no" placeholder="Travel Request No./BTA Code">
                            </div>

                                            <div class="form-group row">
                                                    <label class="col-sm-4">From City</label>
        
                                                    <select class="col-sm-8 form-control  myselect" style="width:66%"  name="from_city" id="from_city"  required>
                                                        <option value="">Select City</option>
                                                        {% for city in cities %}
                                                            <option value="{{city.id}}">{{city.city_name}}</option>
                                                        {% endfor %}
                                                    </select>
                                                
                                            </div>

                                            <div class="form-group row">
                                                    <label class="col-sm-4" >City/Area</label>
                                                    <select class="col-sm-8 form-control  myselect" style="width:66%"  name="city_area" id="city_area"  required>
                                                        <option value="">Select City Area</option>
                                                       {% for city in cities %}
                                                            <option value="{{city.id}}">{{city.city_name}}</option>
                                                        {% endfor %}
                                                    </select>
                                                
                                            </div>

                                            <div class="form-group row">
                                                    <label class="col-sm-4">Preferred Hotel Area</label>
                                                    <input type="text" class="col-sm-8 form-control" name="preferred_hotel_area" id="preferred_hotel_area">
<!--                                                <select class="col-sm-8 form-control  myselect" style="width:66%"  name="preferred_hotel_area" id="preferred_hotel_area"  required>-->
<!--                                                         <option value="">Select Hotel Area</option>-->
<!--                                                        {% for city in cities %}-->
<!--                                                            <option value="{{city.id}}">{{city.city_name}}</option>-->
<!--                                                        {% endfor %}-->
<!--                                                    </select>-->
                                                
                                            </div>

                                        <div class="form-group row">
                                                <label class="col-sm-4">Check In DateTime</label>
                                                <input type="text" class="col-sm-8 form-control datetimepicker1" autocomplete="off" name="check_in_date" id="check_in_date">
                                        </div>
    
                                        <div class="form-group row">
                                                <label class="col-sm-4">Check Out DateTime</label>
                                                <input type="text" class="col-sm-8 form-control datetimepicker1" autocomplete="off" name="check_out_date" id="check_out_date">
                                        </div>  
                                        
                                        
                                        <div class="form-group row">
                                                <label class="col-sm-4">Price Range</label>
                                                <input type="number" class="form-control col-sm-3" name="room_type_priority1" value="1000">
                                                <label class="col-sm-2">To</label>
                                                <input type="number" class="form-control col-sm-3" name="room_type_priority2" value="2000">
                                        </div>

                                        <div class="form-group row">
                                                <label class="col-sm-4" for="room_occupancy">Room Occupancy</label>
    
                                                <select class="col-sm-8 form-control  myselect" style="width:66%"  name="room_occupancy" id="room_occupancy"  required>

                                                </select>
                                            
                                        </div>

                                        <div class="form-group row">
                                            <label class="col-sm-4">Preferred Hotel</label>
                                            <input type="text" class="col-sm-8 form-control" name="preferred_hotel"  placeholder="Preferred Hotel" required>
                                        </div>

                                        
                                        <div class="form-group row">

                                                <label class="col-sm-4">Booking Date/Time</label>
                                                <input type="text" class="col-sm-8 form-control datetimepicker1" id="booking_datetime" autocomplete="off" name="booking_datetime">
        
                                        </div>

                                        <div class="form-group row">
                                            <label class="col-sm-4">Assessment Code/Project Code</label>
                                            <select class="col-sm-8 form-control  myselect" style="width:66%"  name="assessment_code" id="assessment_code"  required>

                                                </select>

                                        </div>



                                        <div class="form-group row">
                                                <label class="col-sm-4">Assessment City</label>
                                                <select class="col-sm-8 form-control  myselect" style="width:66%"  name="assessment_city" id="assessment_cities"  required>

                                                </select>

                                        </div>



                                        <div class="form-group row">
                                                <label class="col-sm-4">Billing Entity</label>
                                                <select class="col-sm-8 form-control  myselect" style="width:66%"  name="billing_entity" id="entity_id"  required>

                                                </select>
                                            
                                        </div>


                                        <div class="form-group row">
                                            <label class="col-sm-4">Reason for Booking</label>
                                            <input type="text" class="col-sm-8 form-control" name="reason_for_booking" placeholder="Reason for Booking" required>
                                        </div>


                                        <div class="form-group row">
                                            <label class="col-sm-4">Send SMS</label>
                                            <select class="col-sm-8 form-control" name="is_sms">

                                                <option value="0">No</option>
                                                <option value="1">Yes</option>
                                            </select>
                                        </div>

                                        <div class="form-group row">
                                            <label class="col-sm-4">Send Email</label>
                                            <select class="col-sm-8 form-control" name="is_email">

                                                <option value="0">No</option>
                                                <option value="1">Yes</option>
                                            </select>
                                        </div>

                                </div>
                            </div>
                        </div>


                                <div class="col-md-8">
                                        <div class="card card-topline-aqua">
                                               <div class="card-head">
                                                   <header>SPOC and Passanger Details</header>
                                                   <a title="add New Employee" class="btn btn-info btn-xs disableClick" data-target="#add_employee_modal" id="add_new_employee_btn" data-toggle="modal" href="#">
                                                <i class="fa fa-plus "></i> Add New Employee </a>
                                                   <div class="tools">
                                                       <a class="fa fa-repeat btn-color box-refresh" href="javascript:;"></a>
                                                       <a class="t-collapse btn-color fa fa-chevron-down" href="javascript:;"></a>
                                                       <a class="t-close btn-color fa fa-times" href="javascript:;"></a>
                                                   </div>
                                               </div>
                                               <div class="card-body ">
                           
                                                    <div class="form-group row">
                                                           <label class="col-sm-2" >Select Spoc*</label>
                                                            <select id="spoc_id" name="spoc_id" class="form-control col-sm-9  myselect" style="width:66%"  >
                                                                 <option value="">Select Spoc </option>
                                                             </select>
                                                       </div>
                           
                                                          <div class="form-group row">
                                                           <label class="col-sm-2" >Number Of Employees*</label>
                                                           <select id="no_of_seats" name="no_of_seats" class="form-control col-sm-9 no_of_seats  myselect" style="width:66%"  >
                                                               <option value="1">1</option>
                                                               <option value="2">2</option>
                                                               <option value="3">3</option>
                                                               <option value="4">4</option>
                                                               <option value="5" style="display: none">5</option>
                                                               <option value="6" style="display: none">6</option>
                                                           </select>
                                                       </div>
                           
                                                          <div class="form-group row" id="emp_row_1">
                                    <label class="col-sm-2" >Employee 1</label>
                                     <select name="employee_id_1" id="employee_id_1" class="form-control col-sm-2  myselect" style="width:13%" >
                                        {% for employee in employees %}
                                        <option value="{{employee.id}}" emp_id="{{employee.id}}">{{employee.employee_name}}/{{employee.employee_cid}}</option>
                                        {% endfor %}
                                    </select>
                                    <input type="text" name="emp_id_1" id="emp_id_1" class="form-control emp-edit col-sm-2" placeholder="Employee Id">
                                   <input type="text" name="employee_name_1" id="employee_name_1" class="form-control emp-edit col-sm-2" placeholder="Name">
                                    <input type="text" name="employee_contact_1" id="employee_contact_1" class="form-control emp-edit col-sm-2" placeholder="Contact No">
                                    <input type="text" name="employee_email_1" id="employee_email_1" class="form-control emp-edit col-sm-2" placeholder="Email">
                                </div>

                              <div class="form-group row" id="emp_row_2">
                                    <label class="col-sm-2" >Employee 2</label>
                                     <select name="employee_id_2" id="employee_id_2" class="form-control col-sm-2  myselect" style="width:13%" >
                                        {% for employee in employees %}
                                        <option value="{{employee.id}}" >{{employee.employee_name}}/{{employee.employee_cid}}</option>
                                        {% endfor %}
                                    </select>
                                   <input type="text" name="emp_id_2" id="emp_id_2" class="form-control emp-edit col-sm-2" placeholder="Employee Id">
                                   <input type="text" name="employee_name_2" id="employee_name_2" class="form-control emp-edit col-sm-2" placeholder="Name">
                                    <input type="text" name="employee_contact_2" id="employee_contact_2" class="form-control emp-edit col-sm-2" placeholder="Contact No">
                                    <input type="text" name="employee_email_2" id="employee_email_2" class="form-control emp-edit col-sm-2" placeholder="Email">
                                </div>

                              <div class="form-group row"  id="emp_row_3">
                                    <label class="col-sm-2" >Employee 3</label>
                                     <select name="employee_id_3" id="employee_id_3" class="form-control col-sm-2  myselect" style="width:13%" >
                                        {% for employee in employees %}
                                        <option value="{{employee.id}}">{{employee.employee_name}}/{{employee.employee_cid}}</option>
                                        {% endfor %}
                                    </select>
                                   <input type="text" name="emp_id_3" id="emp_id_3" class="form-control emp-edit col-sm-2" placeholder="Employee Id">
                                   <input type="text" name="employee_name_3" id="employee_name_3" class="form-control emp-edit col-sm-2" placeholder="Name">
                                    <input type="text" name="employee_contact_3" id="employee_contact_3" class="form-control emp-edit col-sm-2" placeholder="Contact No">
                                    <input type="text" name="employee_email_3" id="employee_email_3" class="form-control emp-edit col-sm-2" placeholder="Email">
                                </div>

                              <div class="form-group row"  id="emp_row_4" >
                                    <label class="col-sm-2" >Employee 4</label>
                                     <select name="employee_id_4" id="employee_id_4" class="form-control col-sm-2  myselect" style="width:13%" >
                                        {% for employee in employees %}
                                        <option value="{{employee.id}}">{{employee.employee_name}}/{{employee.employee_cid}}</option>
                                        {% endfor %}
                                    </select>
                                   <input type="text" name="emp_id_4" id="emp_id_4" class="form-control emp-edit col-sm-2" placeholder="Employee Id">
                                   <input type="text" name="employee_name_4" id="employee_name_4" class="form-control emp-edit col-sm-2" placeholder="Name">
                                    <input type="text" name="employee_contact_4" id="employee_contact_4" class="form-control emp-edit col-sm-2" placeholder="Contact No">
                                    <input type="text" name="employee_email_4" id="employee_email_4" class="form-control emp-edit col-sm-2" placeholder="Email">
                                </div>

                               <div class="form-group row"  id="emp_row_5" >
                                    <label class="col-sm-2" >Employee 5</label>
                                     <select name="employee_id_5" id="employee_id_5" class="form-control col-sm-2  myselect" style="width:13%" >
                                        {% for employee in employees %}
                                        <option value="{{employee.id}}">{{employee.employee_name}}/{{employee.employee_cid}}</option>
                                        {% endfor %}
                                    </select>
                                    <input type="text" name="emp_id_5" id="emp_id_5" class="form-control emp-edit col-sm-2" placeholder="Employee Id">
                                   <input type="text" name="employee_name_5" id="employee_name_5" class="form-control emp-edit col-sm-2" placeholder="Name">
                                    <input type="text" name="employee_contact_5" id="employee_contact_5" class="form-control emp-edit col-sm-2" placeholder="Contact No">
                                    <input type="text" name="employee_email_5" id="employee_email_5" class="form-control emp-edit col-sm-2" placeholder="Email">
                                </div>

                               <div class="form-group row"  id="emp_row_6" >
                                    <label class="col-sm-2" >Employee 6</label>
                                     <select name="employee_id_6" id="employee_id_6" class="form-control col-sm-2  myselect" style="width:13%" >
                                        {% for employee in employees %}
                                        <option value="{{employee.id}}">{{employee.employee_name}}/{{employee.employee_cid}}</option>
                                        {% endfor %}
                                    </select>
                                    <input type="text" name="emp_id_6" id="emp_id_6" class="form-control emp-edit col-sm-2" placeholder="Employee Id">
                                   <input type="text" name="employee_name_6" id="employee_name_6" class="form-control emp-edit col-sm-2" placeholder="Name">
                                    <input type="text" name="employee_contact_6" id="employee_contact_6" class="form-control emp-edit col-sm-2" placeholder="Contact No">
                                    <input type="text" name="employee_email_6" id="employee_email_6" class="form-control emp-edit col-sm-2" placeholder="Email">
                                </div>





                              <input type="hidden" name="emp_no_ref" id="emp_no_ref" value="" >


                           
                                                     </div>
                           

                           
                                           </div>
                                           </div>

                         <div class="col-sm-4"></div>
                <div class="col-sm-4">
                    <div class="text-center">
                        <input type="submit" value="Submit" class="btn btn-info">
                        <a href="{{request.META.HTTP_REFERER}}" class="btn btn-default">  Cancel  </a>
                    </div>
                </div>
                <div class="col-sm-4"></div>
                           

                    </div>
 </form>
  </div>
</div>

<!-- end page content -->

<div id="wait" style="display:none;width:69px;height:89px;border:1px solid black;position:absolute;top:50%;left:50%;padding:2px;z-index:100000;"><img src="{% static 'assets/img/ajax-loader.gif' %}" width="64" height="64" /><br>Loading..</div>


{% else %}
    <p>Welcome, new user. Please log in.<a href="/login">Login</a> </p>
{% endif %}

<script>
$(window).on("load", function () {
var_url = '/api/'+'cities'
    $.ajaxSetup({
            headers:{
                'Authorization': "Token {{request.session.agent_access_token}}",
                'usertype': 10
            }

        });

     $.post(var_url,{},
      function(data)
      {
       //alert(data['Cities']);
       if(data['Cities'].length != 0){
        entities = data['Cities'];
        $('#current_city_id').append($("<option value=''>Select Billing Entity</option>"));
         for (var i=0;i<entities.length;i++) {
            $('#from_city').append($("<option value='"+entities[i].id+"'>"+entities[i].city_name+"</option>"));
            $('#city_area').append($("<option value='"+entities[i].id+"'>"+entities[i].city_name+"</option>"));
         }
       }else{
        alert('No Entity Available')
       }
       });

});
$( document ).ready(function() {

    $('#emp_row_2').hide();
    $('#emp_row_3').hide();
    $('#emp_row_4').hide();
    $('#emp_row_5').hide();
    $('#emp_row_6').hide();

var today = moment().format('DD-MM-YYYY HH:mm');
document.getElementById("booking_datetime").value = today;

});

$("#employee_id_1").change(function()
    {
    	$("#emp_id_1").val($(this).find("option:selected").attr("emp_id"));
    	$("#employee_name_1").val($(this).find("option:selected").attr("emp_name"));
    	$("#employee_contact_1").val($(this).find("option:selected").attr("emp_cnt"));
    	$("#employee_email_1").val($(this).find("option:selected").attr("emp_email"));
    });

$("#employee_id_2").change(function()
    {
    	$("#emp_id_2").val($(this).find("option:selected").attr("emp_id"));
    	$("#employee_name_2").val($(this).find("option:selected").attr("emp_name"));
    	$("#employee_contact_2").val($(this).find("option:selected").attr("emp_cnt"));
    	$("#employee_email_2").val($(this).find("option:selected").attr("emp_email"));
    });

$("#employee_id_3").change(function()
    {
    	$("#emp_id_3").val($(this).find("option:selected").attr("emp_id"));
    	$("#employee_name_3").val($(this).find("option:selected").attr("emp_name"));
    	$("#employee_contact_3").val($(this).find("option:selected").attr("emp_cnt"));
    	$("#employee_email_3").val($(this).find("option:selected").attr("emp_email"));
    });

$("#employee_id_4").change(function()
    {
    	$("#emp_id_4").val($(this).find("option:selected").attr("emp_id"));
    	$("#employee_name_4").val($(this).find("option:selected").attr("emp_name"));
    	$("#employee_contact_4").val($(this).find("option:selected").attr("emp_cnt"));
    	$("#employee_email_4").val($(this).find("option:selected").attr("emp_email"));
    });

$("#employee_id_5").change(function()
    {
    	$("#emp_id_5").val($(this).find("option:selected").attr("emp_id"));
    	$("#employee_name_5").val($(this).find("option:selected").attr("emp_name"));
    	$("#employee_contact_5").val($(this).find("option:selected").attr("emp_cnt"));
    	$("#employee_email_5").val($(this).find("option:selected").attr("emp_email"));
    });

    $("#employee_id_6").change(function()
    {
    	$("#emp_id_6").val($(this).find("option:selected").attr("emp_id"));
    	$("#employee_name_6").val($(this).find("option:selected").attr("emp_name"));
    	$("#employee_contact_6").val($(this).find("option:selected").attr("emp_cnt"));
    	$("#employee_email_6").val($(this).find("option:selected").attr("emp_email"));
    });

$(".no_of_seats").change(function()
    {

    	var no_of_seats = $(this).val();

    	if(no_of_seats > 0){
           for(i=1;i<=no_of_seats;i++)
            {
                $('#emp_row_'+i).show();
                $("#employee_id_"+i).attr('required',true);

            }
            var j = parseInt(no_of_seats) + 1;
			for(j=j; j<=6; j++)
			{
				$('#emp_row_'+j).hide();
				$("#employee_id_"+j).attr('required',false);

			}
    	}
    });


    $("#tour_type").change(function()
    {
    alert('ok')
    	var tour_type = $(this).val();

    	switch(tour_type){
           case '1':
              {
                $('#tr_taxi_type').hide();
                $('#tr_package').hide();
                $('#tr_no_of_days').hide();
                break;
              }
           case '2':
              {
                $('#tr_taxi_type').show();
                $('#tr_package').show();
                $('#tr_no_of_days').hide();
                break;
              }
           case '3':
              {
                $('#tr_taxi_type').show();
                $('#tr_package').show();
                $('#tr_no_of_days').show();
                break;
              }
        }


    });



    $("#corporate_id").change(function(){

      $('#city_id').empty();
      $('#taxi_type_id').empty();
      $('#spoc_id').empty();
      $('#entity_id').empty();
      $('#package_id').empty();
      $('#employee_id_1').empty();
      $('#employee_id_2').empty();
      $('#employee_id_3').empty();
      $('#employee_id_4').empty();
      $('#employee_id_5').empty();
      $('#employee_id_6').empty();
      $('#room_type_priority1').empty();
      $('#room_type_priority2').empty();
      $('#room_occupancy').empty();
    
    
    
       var corporate_id =  $(this).val();
       var_url = '/api/'+'billing_entities'
    
        $.ajaxSetup({
                headers:{
                    'Authorization': "Token {{request.session.agent_access_token}}",
                    'usertype': 10
                }
    
            });
    //   For Entity  
    
         $.post(var_url,{ corporate_id: corporate_id },
          function(data)
          {
           //alert(data['Entitys']);
           if(data['Entitys'].length != 0){
            entities = data['Entitys']
            $('#entity_id').append($("<option value=''>Select Billing Entity</option>"));
             for (var i=0;i<entities.length;i++) {
                $('#entity_id').append($("<option value='"+entities[i].id+"'>"+entities[i].entity_name+"</option>"));
             }
           }else{
            alert('No Entity Available')
           }
           });
    
    //       For SPOC    
    
    
        var_url_spoc = '/api/'+'spocs'
         $.post(var_url_spoc,{ corporate_id: corporate_id },
          function(data)
          {
           //alert(data['Spocs']);
           if(data['Spocs'].length != 0){
            spocs = data['Spocs']
            $('#spoc_id').append($("<option value=''>Select Spoc</option>"));
             for (var i=0;i<spocs.length;i++) {
                $('#spoc_id').append($("<option value='"+spocs[i].id+','+spocs[i].group_id+','+spocs[i].subgroup_id+" '>"+spocs[i].user_name+"</option>"));
    
             }
           }else{
            alert('No SPOC Available')
           }
           });


      //       For Cities

        var_url_spoc = '/api/'+'assessment_cities'
         $.post(var_url_spoc,{ corporate_id: corporate_id },
          function(data)
          {
           if(data['Cities'].length != 0){
            package = data['Cities']
            $('#assessment_cities').append($("<option value=''>Select Assessment City</option>"));
             for (var i=0;i<package.length;i++) {
                $('#assessment_cities').append($("<option value='"+package[i].id+"'>"+package[i].city_name+"</option>"));
             }
           }else{
            alert('No Assessment Cities Available')
           }
           });


             <!--        For assessment_codes    -->
    var_url_spoc = '/api/'+'assessment_codes'
     $.post(var_url_spoc,{ corporate_id: corporate_id },
      function(data)
      {

       if(data['Codes'].length != 0){
        package = data['Codes']
        $('#assessment_code').append($("<option value=''>Select Assessment Code</option>"));
         for (var i=0;i<package.length;i++) {
            $('#assessment_code').append($("<option value='"+package[i].id+"'>"+package[i].assessment_code+"</option>"));
         }
       }else{
        alert('No Assessment Codes Available')
       }
       });

    <!--        For hotel_types    -->
    var_url_spoc = '/api/'+'hotel_types'
     $.post(var_url_spoc,{ corporate_id: corporate_id },
      function(data)
      {

       if(data['Types'].length != 0){
        package = data['Types']
        $('#room_occupancy').append($("<option value=''>Select Room Occupancy</option>"));
         for (var i=0;i<package.length;i++) {
            $('#room_occupancy').append($("<option value='"+package[i].id+"' occupancy='"+package[i].room_occupancy+"'>"+package[i].name+"</option>"));

         }
       }else{
        alert('No Room Type Available')
       }
       });


    <!--        For room_types    -->
    var_url_spoc = '/api/'+'room_types'
     $.post(var_url_spoc,{ corporate_id: corporate_id },
      function(data)
      {

       if(data['Types'].length != 0){
        package = data['Types']
        $('#room_type_priority1').append($("<option value=''>Select Room Type</option>"));
        $('#room_type_priority2').append($("<option value=''>Select Room Type</option>"));
         for (var i=0;i<package.length;i++) {
            $('#room_type_priority1').append($("<option value='"+package[i].id+"'>"+package[i].name+"</option>"));
            $('#room_type_priority2').append($("<option value='"+package[i].id+"'>"+package[i].name+"</option>"));
         }
       }else{
        alert('No Room Type Available')
       }
       });

    });

$("#spoc_id").change(function(){
    var spoc_idd =  $(this).val();
    var spoc_id = spoc_idd.split(",");
      $('#employee_id_1').empty();
      $('#employee_id_2').empty();
      $('#employee_id_3').empty();
      $('#employee_id_4').empty();
      $('#employee_id_5').empty();
      $('#employee_id_6').empty();
    $.ajaxSetup({
            headers:{
                'Authorization': "Token {{request.session.agent_access_token}}",
                'usertype': {{request.session.login_type}}
            }

        });

        //       For Employees

    var_url_spoc_employee = '/api/'+'spoc_employee'
     $.post(var_url_spoc_employee,{ spoc_id: spoc_id[0] },
      function(data)
      {

       if(data['Employees'].length != 0){
        employee = data['Employees'];
        $('#employee_id_1').append($("<option value=''>Select Employee</option>"));
        $('#employee_id_2').append($("<option value=''>Select Employee</option>"));
        $('#employee_id_3').append($("<option value=''>Select Employee</option>"));
        $('#employee_id_4').append($("<option value=''>Select Employee</option>"));
        $('#employee_id_5').append($("<option value=''>Select Employee</option>"));
        $('#employee_id_6').append($("<option value=''>Select Employee</option>"));
         for (var i=0;i<employee.length;i++) {

            $('#employee_id_1').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"/"+employee[i].employee_cid+"</option>"));
            $('#employee_id_2').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"/"+employee[i].employee_cid+"</option>"));
            $('#employee_id_3').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"/"+employee[i].employee_cid+"</option>"));
            $('#employee_id_4').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"/"+employee[i].employee_cid+"</option>"));
            $('#employee_id_5').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"/"+employee[i].employee_cid+"</option>"));
            $('#employee_id_6').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"/"+employee[i].employee_cid+"</option>"));

         }

       var emp_len = data['Employees'].length;
       for (var i=emp_len+1;i<7;i++) {
       var valueToCompare = $("#no_of_seats option[value='"+i+"']").text();
            if(valueToCompare == i) {
                $("#no_of_seats option[value='"+i+"']").attr("disabled", "disabled");
            }
       }

       }else{
        alert('No Employees Available')
       }
       });

});

$("#room_occupancy").change(function(){
    $("#no_of_seats option[value='1']").attr("disabled", false);
    $("#no_of_seats option[value='2']").attr("disabled", false);
    $("#no_of_seats option[value='3']").attr("disabled", false);
    $("#no_of_seats option[value='4']").attr("disabled", false);
    $("#no_of_seats option[value='5']").attr("disabled", false);
    $("#no_of_seats option[value='6']").attr("disabled", false);
    var occupancy =  $(this).find("option:selected").attr("occupancy")
    var text = Number(occupancy) + 1;
    for (var i=text;i<7;i++) {
                $("#no_of_seats option[value='"+i+"']").attr("disabled", "disabled");
       }
});

$("#check_in_date,#check_out_date").change(function()
		{
			var ddStr =  $("#check_in_date").val();
			var adStr =  $("#check_out_date").val();

			var dd = ddStr.replace(" ", "T");
			var ddTime = Date.parse(ddStr);
			var ddDate = new Date(ddTime);

			var ad = adStr.replace(" ", "T");
			var adTime = Date.parse(adStr);
			var adDate = new Date(adTime);

			var d = new Date();

			if(ddTime < adTime)
			{
				//alert("Please select a future Departure date");
				//return false;
				ddTime = adTime + (3600000*24); //Add One day time
				ddDate  = new Date(ddTime);
				var day = ddDate.getDate();
				if(day < 10)
				day = "0"+day;
				var mon = ddDate.getMonth() + 1;
				if(mon < 10)
				mon = "0"+mon;
				var year = ddDate.getFullYear();
				ddString = year + "-" + mon + "-" + day + " 12:00";
				$("#check_in_date").val(ddString);
				$("#no_of_nights").val(1);
			}
			else
			{
				var diff = ddTime - adTime;
				var day_diff = diff/(3600000*24);
				days = Math.round(day_diff);
				var adHour = adDate.getHours();
				var adMin = adDate.getMinutes();
				if(adMin > 0)
				{
					if(adHour != '11')
					{
						adHour += 1;
					}
				}
				var ddHour = ddDate.getHours();
				var ddMin = ddDate.getMinutes();
				if(ddMin > 0)
				ddHour += 1;
				if(adHour < 12 && ddHour <= 12)
				days += 1;
				if(adHour < 12 && ddHour > 12)
				{
					days += 2;
				}
				if(adHour >= 12 && ddHour > 12)
				days += 1;
				if(days > 1)
				$("#no_of_nights").val(days-1);
				else
				$("#no_of_nights").val(1);
			}
		});
</script>


<script type="text/javascript">
$('.emp-edit').on('click',function(e) {

 str_id = e.target.id;

 var emp_no = str_id.charAt(str_id.length-1);

 $('#emp_no_ref').val(emp_no);

 employee_id = 'employee_id_'+emp_no;

 var emp = document.getElementById(employee_id).value;

if (emp == '') {

    //alert("Please select a employee first");
    document.getElementById(employee_id).focus();
    //$(this).focus();
        // break
        return false;

}else{

    $('#update_employee_modal').modal();
}


});


</script>


<script type="text/javascript">
$(function() {

  $('#update_employee_modal').on('show.bs.modal', function (event) {
    /*var button = $(event.relatedTarget); // Button that triggered the modal
    var id = button.data('id');
    var coreid = button.data('coreid');
    var name = button.data('name');
    var email = button.data('email');
    var contact = button.data('contact');*/

    emp_no = $('#emp_no_ref').val();

    employee_id = 'employee_id_'+emp_no;
    emp_id = document.getElementById(employee_id);

    employee_core_id = 'emp_id_'+emp_no;
    emp_core_id = document.getElementById(employee_core_id);

    employee_name = 'employee_name_'+emp_no;
    emp_name = document.getElementById(employee_name);

    employee_email = 'employee_email_'+emp_no;
    emp_email = document.getElementById(employee_email);

    employee_contact = 'employee_contact_'+emp_no;
    emp_contact = document.getElementById(employee_contact);

    var id = emp_id.value;
    var coreid = emp_core_id.value;
    var name = emp_name.value;
    var email = emp_email.value;
    var contact = emp_contact.value;


    var modal = $(this);
    modal.find('#core_employee_id').val('');
    modal.find('#employee_name').val('');
    modal.find('#employee_email').val('');
    modal.find('#employee_contact').val('');
    modal.find('#employee_id').val('');

    modal.find('#core_employee_id').val(coreid);
    modal.find('#employee_name').val(name);
    modal.find('#employee_email').val(email);
    modal.find('#employee_contact').val(contact);


    modal.find('#employee_id').val(id);




    });

});



</script>

<script>


$("#modal_add_employee").submit(function(e) {

    e.preventDefault(); // avoid to execute the actual submit of the form.
    var form = $(this);
    var url = form.attr('action');

    $.ajax({
           type: "POST",
           url: url,
           data: form.serialize(), // serializes the form's elements.
           beforeSend: function(){
                $("#wait").css("display", "block");
            },
            complete: function(){
                $("#wait").css("display", "none");
            },
           success: function(data)
           {


              if (data == "1")
              {

                $("#add_employee_modal").modal("hide");

                $('#sel').val(1);

               spoc_change(1);

               alert("employee added successfully");

              }else{

              alert("error in data insert");

              }



           }
         });

});


$("#modal_update_employee").submit(function(e) {

    e.preventDefault(); // avoid to execute the actual submit of the form.
    var form = $(this);
    var url = form.attr('action');

    $.ajax({
           type: "POST",
           url: url,
           data: form.serialize(), // serializes the form's elements.
           beforeSend: function(){
                $("#wait").css("display", "block");
            },
            complete: function(){
                $("#wait").css("display", "none");
            },
           success: function(data)
           {
             //alert(data);

             emp_core_id = data['employee'][0].employee_id
             emp_name = data['employee'][0].name
             emp_email = data['employee'][0].email
             emp_contact = data['employee'][0].contact

             //alert(emp_name);

             $("#update_employee_modal").modal("hide");

             emp_no = $('#emp_no_ref').val();

           employee_id = '#employee_id_'+emp_no;
           // document.getElementById(employee_id).val(emp_core_id) ;

           $( "#employee_id_1 option:selected" ).text(emp_name);

           //alert($( "#employee_id_1 option:selected" ).text());

           //document.getElementById("employee_id_1").text = "newTextForApple";

           //alert(aaa);

            employee_core_id = 'emp_id_'+emp_no;
            e_core_id = document.getElementById(employee_core_id);
            e_core_id.value = emp_core_id;

            employee_name = 'employee_name_'+emp_no;
            e_name = document.getElementById(employee_name);
            e_name.value = emp_name

            employee_email = 'employee_email_'+emp_no;
            e_email = document.getElementById(employee_email);
            e_email.value = emp_email

            employee_contact = 'employee_contact_'+emp_no;
            e_contact = document.getElementById(employee_contact);
            e_contact.value = emp_contact;

           }
         });

});




$("#corporate_id2").change(function(){

  $('#spoc_id2').empty();
  $('#billing_entity_id2').empty();

   var corporate_id =  $(this).val();

    $.ajaxSetup({
            headers:{
                'Authorization': "Token {{request.session.agent_access_token}}",
                'usertype': 10
            }

        });
//   For Entity
var_url = '/api/'+'billing_entities'
     $.post(var_url,{ corporate_id: corporate_id },
      function(data)
      {
       //alert(data['Entitys']);
       if(data['Entitys'].length != 0){
        entities = data['Entitys']
        $('#billing_entity_id2').append($("<option value=''>Select Entity</option>"));
         for (var i=0;i<entities.length;i++) {
            $('#billing_entity_id2').append($("<option value='"+entities[i].id+"'>"+entities[i].entity_name+"</option>"));
         }
       }else{
        alert('No Entity Available')
       }
       });

//       For SPOC


    var_url_spoc = '/api/'+'spocs'
     $.post(var_url_spoc,{ corporate_id: corporate_id },
      function(data)
      {
       //alert(data['Spocs']);
       if(data['Spocs'].length != 0){
        spocs = data['Spocs']
        $('#spoc_id2').append($("<option value=''>Select Spoc</option>"));
         for (var i=0;i<spocs.length;i++) {
            $('#spoc_id2').append($("<option value='"+spocs[i].id+"'>"+spocs[i].user_name+"</option>"));

         }
       }else{
        alert('No SPOC Available')
       }
       });


    var_url_spoc = '/api/'+'employees'
     $.post(var_url_spoc,{ corporate_id: corporate_id },
      function(data)
      {
       //alert(data['Employees']);
       if(data['Employees'].length != 0){
        spocs = data['Employees']
        $('#assistant_id').append($("<option value=''>Select Employee</option>"));
         for (var i=0;i<spocs.length;i++) {
            $('#assistant_id').append($("<option value='"+spocs[i].id+"'>"+spocs[i].employee_name+"</option>"));

         }
       }else{
        alert('No Employee Available')
       }
       });



});



$("#spoc_id").change(spoc_change);

function spoc_change(flag){

    var spoc_idd =  $("#spoc_id").val();
    var spoc_id = spoc_idd.split(",");

    //alert("spoc event");

   var element = document.getElementById("add_new_employee_btn");
   element.classList.remove("disableClick");


    $.ajaxSetup({
            headers:{
                'Authorization': "Token {{request.session.agent_access_token}}",
                'usertype': 10
            }

        });

        //       For Employees


    var_url_spoc_employee = '/api/'+'spoc_employee'
     $.post(var_url_spoc_employee,{ spoc_id: spoc_id[0] },
      function(data)
      {

      //alert(data);

       if(data['Employees'].length != 0){
        employee = data['Employees'];

        if (flag != 1 )
        {

            $('#employee_id_1').empty();
            $('#employee_id_2').empty();
            $('#employee_id_3').empty();
            $('#employee_id_4').empty();
            $('#employee_id_5').empty();
            $('#employee_id_6').empty();



        $('#employee_id_1').append($("<option value=''>Select Employee</option>"));
        $('#employee_id_2').append($("<option value=''>Select Employee</option>"));
        $('#employee_id_3').append($("<option value=''>Select Employee</option>"));
        $('#employee_id_4').append($("<option value=''>Select Employee</option>"));
        $('#employee_id_5').append($("<option value=''>Select Employee</option>"));
        $('#employee_id_6').append($("<option value=''>Select Employee</option>"));

         for (var i=0;i<employee.length;i++) {

            $('#employee_id_1').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
            $('#employee_id_2').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
            $('#employee_id_3').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
            $('#employee_id_4').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
            $('#employee_id_5').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
            $('#employee_id_6').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));

         }


         }else{

            emp_no = $('#no_of_seats').val();

            //alert(emp_no);

            $('#employee_id_1').append($("<option value=''>Select Employee</option>"));
            $('#employee_id_2').append($("<option value=''>Select Employee</option>"));
            $('#employee_id_3').append($("<option value=''>Select Employee</option>"));
            $('#employee_id_4').append($("<option value=''>Select Employee</option>"));
            $('#employee_id_5').append($("<option value=''>Select Employee</option>"));
            $('#employee_id_6').append($("<option value=''>Select Employee</option>"));


             for (var i=0;i<employee.length;i++) {

             //$(selected_id).append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
                $('#employee_id_1').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
                $('#employee_id_2').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
                $('#employee_id_3').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
                $('#employee_id_4').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
                $('#employee_id_5').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));
                $('#employee_id_6').append($("<option value='"+employee[i].id+"' emp_id='"+employee[i].employee_cid+"' emp_cnt='"+employee[i].employee_contact+"' emp_name='"+employee[i].employee_name+"' emp_email='"+employee[i].employee_email+"' >"+employee[i].employee_name+"</option>"));

              }

         }

       var emp_len = data['Employees'].length;
       for (var i=emp_len+1;i<7;i++) {
       var valueToCompare = $("#no_of_seats option[value='"+i+"']").text();
            if(valueToCompare == i) {
                $("#no_of_seats option[value='"+i+"']").attr("disabled", "disabled");
            }
       }

       }else{
        alert('No Employees Available');
       }
       });



}



</script>





{% endblock %}